안녕하세요, 여러분! 이번 시간에는 지금까지 배운 내용을 종합하여 전체 시스템을 설계해보겠습니다.

## 시스템 구축의 필요성

지금까지 우리는 데이터를 가져와서 시각화하고, 분석 보고서를 작성하고, 자동 매매까지 구현해봤는데요. 이제 이 코드들을 체계적으로 정리해서 하나의 완성된 시스템으로 만들어볼 차례입니다.

~~특히 원하는 종목을 무엇이든 검색할 수 있고,~~

~~차트와 분석 결과를 한눈에 볼 수 있는 대시보드를 구축한다면,~~

~~우리의 투자 판단을 더욱 효율적으로 내릴 수 있겠죠?~~

## 1. Streamlit 소개

대시보드를 만들기 위해 우리는 'streamlit(스트림릿)'이라는 라이브러리를 사용할 건데요, ~~이 라이브러리가 무엇인지 간단히 알아볼게요.~~

Streamlit은 파이썬으로 처리한 데이터를 웹 애플리케이션으로 쉽게 보여주기 위한 라이브러리입니다. 가장 큰 장점은 프론트엔드나 웹 개발 지식이 거의 없어도 사용할 수 있다는 점이에요. 몇 줄의 코드만으로도 인터랙티브한 대시보드를 만들 수 있고, 특히 데이터 분석이나 머신러닝 프로젝트에 아주 유용하게 쓰입니다.

~~Streamlit 앱을 실행하는 방법은 아주 간단해요. 터미널에서 다음 명령어만 입력하면 됩니다.~~

```bash
pip install streamlit
```

```python
streamlit run app.py  # app.py는 우리가 만들 메인 파일 이름
```

~~이 명령어를 실행하면 자동으로 웹 브라우저가 열리고, 우리가 만든 대시보드를 바로 볼 수 있어요.~~

## 2. 대시보드 UI 설계

![image.png](attachment:636ccf9f-494a-4c31-89a9-45bfe74e331e:d6dc25d5-9b9b-4ae1-abda-13e116e7b706.png)

실제 구현에 앞서 대시보드의 UI를 어떻게 구성할지 생각해볼 필요가 있는데요.

우리 대시보드는 크게 다섯 부분으로 나눠볼 수 있어요.

먼저 종목 선택이나 조회 기간 설정 같은 사용자 입력을 받는 컨트롤 영역,

그리고 주가 차트와 기술적 지표를 시각화하는 차트 영역이 필요하겠죠.

또한 AI가 생성한 분석 보고서를 표시하는 기본적 분석, 기술적 분석, 뉴스 분석 영역도 필요할 거예요.

기본적 분석 영역에는 보고서와 함께, 기업의 주요 재무 지표까지 표와 그래프로 보여주도록 할게요.

## 3. 전체 시스템 구조 설계

이제 우리 시스템의 전체 구조를 설계해볼텐데요,

데이터의 흐름을 살펴보면 다음과 같이 정리할 수 있습니다.

먼저 증권 API나 다른 데이터 소스에서 원본 데이터를 가져옵니다.

그 다음 이 데이터를 정리하고 관리하는 기능이 필요하고요.

다음으로 이 데이터를 활용해 분석 결과를 생성하고, 저장합니다.

마지막으로 대시보드에서는 이 분석 결과를 종합해 사용자에게 보여주는거죠.

![수정 전](attachment:c600edd2-fb0e-46bc-95ce-75a81f3465ca:image.png)

수정 전

![수정본](attachment:eac6c0ea-6bf7-4ffb-b1e7-70d2fde2ddb2:image.png)

수정본

이 데이터 흐름에 맞게 전체 시스템의 구조를 설정합니다.

이때 개별 기능은 비슷한 것끼리 묶어서 모듈 또는 패키지로 설계하고,

중요합니다.

이 과정을 앞으로 네 단계에 걸쳐서 살펴볼텐데요,

첫 번째는 한국투자증권 API와 통신을 담당하는 부분을 어떻게 구현하는지 알아보겠습니다.

다음으로 차트/재무/뉴스 데이터를 관리하는 기능들을 구현합니다.

세 번째는 분석 부분으로, 이 데이터를 분석해서 차트, 지표, 뉴스 보고서를 생성하는 역할을 맡습니다.

마지막으로 대시보드 구현 부분은 분석 결과를 시각적으로 표현하고 사용자와 상호작용하는 역할을 하게 됩니다.

## 4. 기능 명세 작성

https://docs.google.com/spreadsheets/d/1mGl4ryUOX8dKjlhWO35f_Ol0nLyxCKCooJL_knREdGQ/edit?gid=1838755942#gid=1838755942

![image.png](attachment:84e1a08e-afc0-4a60-93ef-7ce303aceedb:c06ac68d-eb92-456d-88c3-f7ade711ab83.png)

이렇게 설정한 구조에 따라 기능 명세서를 작성해볼 텐데요, 이 문서는 왜 필요할까요?

기능 명세서는 우리가 구현할 기능들과 그 상세 설명, 구현 여부, 우선 순위 등을 담은 문서예요.

앞에서 말씀드렸던 기능들을, 실제로 구현되는 단위로 자세히 정리한 거라고 보시면 됩니다.

이렇게 명확하게 정리해두면 프로젝트를 체계적으로 관리하고 진행 상황을 추적하는 데 큰 도움이 됩니다.

이 기능들의 개발 우선순위와 개발 상태를 함께 정리해서 명세서에 표시해두면, 프로젝트 진행 상황을 한눈에 파악할 수 있거든요.

특히 더 큰 프로젝트에서, 다른 사람들과 협업해야 할 일이 생긴다면 유용할테니 참고해주세요.

## 5. 프로젝트 디렉토리 구조

```python
# 디렉토리 구조
project
├── app.py  # Streamlit 대시보드 진입점
│
├── analysis # 분석 패키지
│   ├── __init__.py
│   ├── technical.py           # 기술 분석 클래스
│   ├── fundamental.py         # 기본 분석 클래스
│   ├── news.py                # 뉴스 분석 클래스
│   ├── report_manager.py      # 보고서 관리 클래스
│   └── analysis_settings.json # 뉴스, 기본, 기술 보고서 업데이트 주기
│
├── data_loader # 데이터 관리 패키지
│   ├── __init__.py
│   ├── chart.py               # 차트 데이터 수집기
│   ├── financials.py          # 재무제표 수집기
│   ├── news.py                # 뉴스 수집기
│   └── settings.json          # 차트, 뉴스 데이터 업데이트 주기
│
├── kis # KIS API 소통 패키지
│   ├── __init__.py
│   └── kis.py
│
├── report                     # 보고서 저장소
│   ├── fundamental
│   │   ├── dom
│   │   └── ovs
│   ├── technical
│   │   ├── dom
│   │   └── ovs
│   └── news
│       ├── dom
│       └── ovs
│
├── data                        # 데이터 저장소
│   ├── charts
│   │   ├── dom
│   │   └── ovs
│   ├── financials
│   │   ├── dom
│   │   └── ovs
│   ├── news
│   │   ├── dom
│   │   └── ovs
│   └── stock_codes
│       ├── dom
│       └── ovs
│
├── config
│   ├── config.yaml             # API 키 및 요청 설정, OpenAI 클라이언트(gitignore)
│   ├── config_example.yaml     # 예시 yaml 제공
│   └── config_loader.py        # API 키 로딩, OpenAI 클라이언트 등
│
├── requirements.txt
└── README.md
```

# 프로젝트 구조 설명

이제 실제 파일과 폴더 구조를 어떻게 구성할지 알아볼게요.

앞에서 크게 네 가지 기능이 필요했었는데요, 프로젝트 최상위 폴더 안에 담당하는 기능에 따라 폴더를 구분하여 생성합니다.

- 정리

  ```sql
  KIS
    -> kis.py

  data_loader
    -> chart.py
    -> financials.py
    -> news.py
    -> settings.json

  analysis
    -> technical.py
    -> fundamental.py
    -> news.py

    -> report_manager.py
    -> analysis_settings.json

  app.py

  config
    -> config_example

  data
    -> 하나 있는거 ㅇㅇ

  report
    ->
  ```

`kis` 폴더에는 KIS API와 통신하는 모듈(`kis.py`)이 들어갑니다.

그리고 여기에 `__init__.py` 파일을 추가하여, 다른 파이썬 코드에서 패키지로 인식할 수 있게 합니다.

`data_loader` 패키지에서는 차트, 재무 정보, 뉴스 데이터를 수집, 정리하고 관리합니다.

데이터 종류 별로 각각의 기능을 별도의 모듈로 만들고, 하나의 패키지로 묶어 사용하기 편하게 합니다.

또 이 패키지에는 갱신 주기를 설정하는 설정 파일도 포함합니다.

`analysis` 패키지에는 분석을 직접 수행하는 모듈들이 들어갑니다.

여기서는 기술적 분석, 기본적 분석, 뉴스 분석, 이렇게 분석의 종류 별로 모듈을 하나씩 만들어줍니다.

추가로 보고서 관리 기능을 담당하는 `report_manager.py`, 그리고 분석 실행 주기를 설정하는 파일을 구현할 것입니다.

여기서도 마찬가지로, 이 모듈들을 묶어 analysis 패키지로 만들게요.

마지막으로 대시보드 모듈 `app.py`는 모든 패키지와 모듈을 하나로 통합해 사용자와 상호작용합니다.

이 파일은 Streamlit 기반의 대시보드를 구현하여 사용자 인터페이스를 제공합니다.

기능명세서와 대조해보면, 중분류에 해당하는 기능을 모듈(`.py` 파일)로 설계하고, 그 상위의 대분류는 패키지(폴더 + `__init__.py`)로 구현하려는 것을 알 수 있습니다. 소분류 수준의 기능은 각 모듈 내부의 클래스와 메서드로 구현되겠죠.

이렇게 구조화하면 기능별로 코드가 명확히 분리되어 유지보수와 확장이 쉬워질 겁니다.

그 외의 부가적인 기능과 폴더를 살펴볼게요.

config 폴더에서는 보안과 안정성을 위해 API 키, 계좌번호 같은 정보를 관리합니다.

또 data 폴더에는 데이터 관리 코드에서 가져온 원본 데이터,

report 폴더에는 분석 코드에서 생성한 보고서를 저장합니다.

자세한 구현 방식은 남은 강의에서 다룰 예정입니다.

## 마무리

이번 강의에서는 우리가 구축할 전체 시스템의 설계를 알아보았는데요. Streamlit을 활용한 대시보드의 기본 개념과 전체 시스템 구조, 기능 명세서의 개념, 디렉토리 구조까지 살펴봤습니다.

다음 강의부터는 이 설계를 바탕으로 실제 구현을 시작할 건데요.

네 가지 큰 기능 요소들을 어떻게 긴밀하게 연결할 수 있는지, 또 그 과정에서 필요한 부가 기능은 무엇이 있는지 차근차근 알아보겠습니다.

~~먼저 다음 강의에서는 KIS 패키지와 기본 설정부터 구현해 볼게요.~~

~~여러분도 이 설계를 참고해서 자신만의 투자 분석 시스템을 만들어보세요. 시스템의 규모나 복잡도는 여러분의 필요에 맞게 조절할 수 있답니다.~~

그럼 다음 시간에 만나요!

---

### **1️⃣ Streamlit 라이브러리**

- Streamlit은 파이썬으로 처리한 데이터를 웹 애플리케이션으로 쉽게 보여주는 라이브러리입니다.
  - 웹 개발 지식 없이도 인터랙티브한 대시보드를 만들 수 있습니다.
  - 데이터 분석이나 머신러닝 프로젝트를 시각화하는 데 특히 유용합니다.
- 터미널에서 다음과 같이 streamlit을 설치하고 실행합니다.
  - app.py는 우리가 만들 메인 파일 이름입니다.

```bash
pip install streamlit
streamlit run app.py
```

### 2️⃣ **대시보드 UI 설계**

- 대시보드 UI는 다음 영역으로 구성합니다.
  - 사용자 컨트롤 영역: 종목 선택, 조회 기간 설정 등을 담당합니다.
  - 차트 영역: 주가 차트와 기술적 지표를 시각화합니다.
  - 분석 보고서 영역: 기본적 분석, 기술적 분석, 뉴스 분석 결과를 영역을 나누어 표시합니다.

### 3️⃣ **전체 시스템 구조 설계**

- 전체 시스템에는 데이터 흐름의 순서대로 다음과 같은 기능이 필요합니다.
  - 데이터 수집: 증권 API 등에서 원본 데이터 가져오기
  - 데이터 관리: 데이터 정리 및 저장
  - 데이터 분석: 수집된 데이터로 분석 결과 생성
  - 시각화: 분석 결과를 종합해 사용자에게 보여주기
- 각 세부 기능을 개별 모듈로 설계하여 코드 관리를 효율화합니다.
  - API 통신 구현: 한국투자증권 API와 통신합니다.
  - 데이터 관리: 차트/재무/뉴스 데이터를 관리합니다.
  - 데이터 분석: 데이터를 분석하고 보고서를 생성합니다.
  - 대시보드 구현: 분석 결과를 시각화하고 사용자와 상호작용합니다.

<aside>
➕

**모듈화의 이점**

- 코드 재사용성 향상: 각 기능을 독립된 모듈로 구현하면 다른 프로젝트에서도 재사용할 수 있습니다.
- 유지보수 용이성: 각 모듈의 기능이 분리되어 있으므로 테스트, 디버깅을 해당 모듈에서 쉽게 수행할 수 있습니다.
- 가독성 향상: 코드가 논리적으로 분리되어 전체 시스템을 이해하기 쉽습니다.
- 확장성: 새로운 기능이 필요할 때 기존 구조를 변경하지 않고 모듈을 추가할 수 있습니다.
</aside>

### 4️⃣ **기능 명세서와 프로젝트 디렉토리**

- 기능 명세서는 개발 프로젝트에서 구현할 기능, 상세 설명, 구현 여부, 개발 우선순위를 정리한 문서입니다.
  - 체계적인 프로젝트 관리와 진행 상황 추적에 도움이 됩니다.
  - 특히 협업 프로젝트에서 유용합니다.
- 프로젝트 디렉토리는 기능별로 구조화합니다.
  - app.py: Streamlit 대시보드 진입점
  - kis: 한국투자증권 API 통신 모듈
  - data_loader: 데이터 수집 및 관리 패키지
  - analysis: 데이터 분석 및 보고서 생성 패키지
  - data, report: 원본 데이터와 분석 보고서 저장 디렉토리
  - config: API 키 등 보안 정보 관리

```python
# 디렉토리 구조
project
├── app.py  # Streamlit 대시보드 진입점
│
├── analysis # 분석 패키지
│   ├── __init__.py
│   ├── technical.py           # 기술 분석 모듈
│   ├── fundamental.py         # 기본 분석 모듈
│   ├── news.py                # 뉴스 분석 모듈
│   ├── report_manager.py      # 보고서 관리 모듈
│   └── analysis_settings.json # 뉴스, 기본, 기술 보고서 업데이트 주기
│
├── data_loader # 데이터 관리 패키지
│   ├── __init__.py
│   ├── chart.py               # 차트 데이터 수집기
│   ├── financials.py          # 재무제표 수집기
│   ├── news.py                # 뉴스 수집기
│   └── settings.json          # 차트, 뉴스 데이터 업데이트 주기
│
├── kis # KIS API 소통 패키지
│   ├── __init__.py
│   └── kis.py
│
├── report                     # 보고서 저장소
│   ├── fundamental
│   │   ├── dom
│   │   └── ovs
│   ├── technical
│   │   ├── dom
│   │   └── ovs
│   └── news
│       ├── dom
│       └── ovs
│
├── data                        # 데이터 저장소
│   ├── charts
│   │   ├── dom
│   │   └── ovs
│   ├── financials
│   │   ├── dom
│   │   └── ovs
│   └── news
│       ├── dom
│       └── ovs
│
├── config
│   ├── config.yaml             # API 키, 계좌번호 등 저장
│   ├── config_example.yaml     # 예시 yaml 제공
│   └── config_loader.py        # API 키 로딩, OpenAI 클라이언트 초기화 등
│
├── requirements.txt
└── README.md
```
